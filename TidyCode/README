tidyed up code, gui needs documentation 
